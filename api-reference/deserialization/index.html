<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Deserialization - FlashHTTP Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Deserialization";
        var mkdocs_page_input_path = "api-reference/deserialization.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> FlashHTTP Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Building and Testing</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../building-and-testing/installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../building-and-testing/benchmarks/">Benchmarks</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../serialization/">Serialization</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Deserialization</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#http1_deserialize">http1_deserialize</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#description">Description</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#returns">Returns</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#undefined-behavior">Undefined Behavior</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#errors">Errors</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../data-structures/">Data Structures</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../examples/">Examples</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">FlashHTTP Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API Reference</li>
      <li class="breadcrumb-item active">Deserialization</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/Raimo33/FlashHTTP/edit/master/docs/api-reference/deserialization.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="deserialization">Deserialization</h1>
<p>The following function prototypes can be found in the <code>deserialization.h</code> header file.</p>
<pre><code class="language-c">#include &lt;flashhttp/deserialization.h&gt;
</code></pre>
<p>These functions <strong>only verify the structural integrity</strong> of messages in terms of format. The body is served raw, without any decoding or parsing. It is up to the user to interpret the headers and eventually decode the body. Duplicate headers are not concatenated, but stored as separate fields.</p>
<h2 id="http1_deserialize">http1_deserialize</h2>
<pre><code class="language-c">uint32_t http1_deserialize(char *restrict buffer, const uint32_t buffer_size, http_response_t *const restrict response);
</code></pre>
<h3 id="description">Description</h3>
<p>deserializes a http1 response in-place by replacing delimiters with <code>'\0'</code> and storing the pointers to the fields in the <code>response</code> struct. For the body, <code>response-&gt;body</code> will be set to the start of the body in the buffer or <code>NULL</code> if the buffer ends after the headers.</p>
<h3 id="parameters">Parameters</h3>
<ul>
<li><code>buffer</code> - the buffer which contains the full serialized response</li>
<li><code>buffer_size</code> - the size of the buffer in bytes</li>
<li><code>response</code> - the response struct where to store the deserialized fields, with the following conditions:</li>
<li><code>headers</code> already allocated with a number of fields that matches the expected number of headers</li>
<li><code>headers_count</code> set to the number of allocated headers</li>
<li>everything else should be zeroed (<code>0</code>' or <code>NULL</code>)</li>
</ul>
<h3 id="returns">Returns</h3>
<ul>
<li>length of the deserialized message in bytes, minus the body</li>
<li><code>0</code> in case of error (see <a href="#errors">Errors</a>)</li>
</ul>
<h3 id="undefined-behavior">Undefined Behavior</h3>
<ul>
<li><code>buffer</code> is <code>NULL</code></li>
<li><code>response</code> is <code>NULL</code></li>
<li><code>response-&gt;headers</code> is not allocated</li>
<li><code>buffer_size</code> is different from the actual size of the buffer</li>
<li><code>buffer</code> does not contain a full http response</li>
</ul>
<h3 id="errors">Errors</h3>
<ul>
<li>wrong or missing status code</li>
<li>missing reason phrase</li>
<li>too many headers</li>
<li>missing colon in header</li>
<li>missing header key</li>
<li>missing header value</li>
<li>more than UINT16_MAX headers in the response</li>
<li>reason phrase longer than UINT16_MAX</li>
<li>header key longer than UINT16_MAX</li>
<li>header value longer than UINT16_MAX</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../serialization/" class="btn btn-neutral float-left" title="Serialization"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../data-structures/" class="btn btn-neutral float-right" title="Data Structures">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/Raimo33/FlashHTTP" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../serialization/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../data-structures/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
